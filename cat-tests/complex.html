<html>
<head><meta http-equiv="Content-Type" content="text/plain; charset=utf-8">
    <meta name="x-cat-tags" content="anyStock actualBugJson actualBugXml"/>

    <script src="../../libs/closure-library/closure/goog/base.js"></script>
    <script src="../../src/deps.js"></script>
    <link href="../../out/anychart-ui.min.css" type="text/css" rel="stylesheet">
    <script>
      goog.require("anychart.bundle.entry");
      goog.require("anychart.themes.defaultTheme.entry");
      window.ACDVF = true;
    </script>
    <script src="utils/anytest.min.js"></script>


    <script src="http://cat.anychart.com/static/sessions/15206/branch/out/local-cdn/csv-data/orcl-daily-short.js"></script>
    <script src="http://cat.anychart.com/static/sessions/15206/branch/out/local-cdn/csv-data/msft-daily-short.js"></script>
</head>
<body>
<div id="container"></div>
</body>
<script>
  var chart, priceIndicator1, priceIndicator2, priceIndicator3, series10, series20;
  anychart.onDocumentLoad(function() {
    anytest.setUp(600,500);
    var dataTable = anychart.data.table();
    dataTable.addData(get_orcl_daily_short_data());

    var dataTable1 = anychart.data.table();
    dataTable1.addData(get_msft_daily_short_data());

    var mapping1 = dataTable.mapAs({value:2});
    var mapping2 = dataTable1.mapAs({value:4});
    var mapping = dataTable.mapAs();
    mapping.addField('open', 1, 'open');
    mapping.addField('high', 2, 'high');
    mapping.addField('low', 3, 'low');
    mapping.addField('close', 4, 'close');
    mapping.addField('volume', 5, 'average');

    chart = anychart.stock();
    chart.padding(10,50,10,50);

    var Plot1 = chart.plot();
    var Plot2 = chart.plot(1);

    priceIndicator1 = Plot1.priceIndicator(0);
    Plot2.height(200);
    priceIndicator2 = Plot2.priceIndicator(0);
    chart.plot(0, {legend: false});
    chart.plot(1, {legend: false});
    anytest.drawInStage(chart);

    anytest.stageListen(function () {
      anytest.step(function() {
        Plot1 = chart.plot();
        Plot2 = chart.plot(1);
        priceIndicator1 = Plot1.priceIndicator(0);
        priceIndicator2 = Plot2.priceIndicator(0);
        anytest.CAT.getScreen();
      });
      anytest.step(function(){
        Plot1.addSeries(mapping2);
        Plot1.getSeriesAt(0)
            .seriesType('jump-line');
        Plot1.getSeriesAt(0).id('First');
        priceIndicator1.series('First')
            .value(Date.UTC(2006, 5, 13));
        chart.selectRange('2006-06-02','2006-06-18');
        anytest.CAT.getScreen('addPriceInidicator1Series', -1);
      });
      anytest.step(function() {
        Plot2.addSeries(mapping2);
        Plot2.getSeriesAt(0).seriesType('column');
        priceIndicator2.series(0)
            .value('first-visible').stroke('2 red');
        anytest.CAT.getScreen('add2ndIndicator', -1, 'addPriceInidicator1Series');
      });
//      anytest.step(function() {
//        Plot1.removeAllSeries();
//        Plot2.removeAllSeries();
//        Plot1.yScale().startAutoCalc() // иначе шкала не сбросится до дефолтов
//            .finishAutoCalc();
//        Plot2.yScale().startAutoCalc()
//            .finishAutoCalc();
//        anytest.CAT.getScreen('backToInitialState', 1);
//      });
      anytest.exit();
    }).charts4modes('chart');
//        anytest.createPanel('interactive');
    stage.resume();
    /*<< methods
     anychart.stockModule.CurrentPriceIndicator.series
     >>*/
  });
</script>
</html>